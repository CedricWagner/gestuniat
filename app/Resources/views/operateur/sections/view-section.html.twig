{% extends 'base.html.twig' %}

{% block title %}
Gestuniat - Section {{ section.nom }}
{% endblock %}

{% block additionnal_classes %}internal has-left-column{% endblock %}


{% block left_column %}

	{% include 'operateur/sections/infos-gen.inc.html.twig'  %}

{% endblock %}

{% block content %}
	<h2>Accueil section</h2>
	<br />
	<div class="row">
		<div class="col-md-4 col-sm-12">
			<div class="section-block">
				<div class="section-header">
					<h3>Suivi section</h3>
				</div>
				<div class="section-main-content">
					<button class="btn btn-primary btn-block" data-toggle="modal" data-target="#add-suivi-default"><span class="glyphicons glyphicons-pen" aria-hidden="true"></span>Rédiger un nouveau commentaire</button>
					{% include 'modals/ajouter-suivi-default.html.twig' %}
					<small class="label-print-all"><a href="#">Imprimer la sélection</a></small>
				</div>
				<div class="section-sub-content">
					{% for suivi in lstSuivis %}
						{% include 'operateur/contacts/suivi-item.inc.html.twig' with {'suivi': suivi} %}
					{% endfor %}
				</div>
				<div class="section-main-content">
					<button class="btn btn-default btn-block" data-toggle="modal" data-target="#liste-all-suivi">Voir tous les suivis >></button>
					{% include 'modals/liste-suivis.html.twig' %}
				</div>
			</div>
		</div>
		<div class="col-md-8 col-sm-12">
			<div class="row">
				<div class="col-md-4">
					<div class="section-block">
						<div class="section-header">
							<h3>Gestion des timbres</h3>
						</div>
						<div class="section-main-content">
							<p>Pour l'année en cours : </p>
							<div class="btn-group-vertical" role="group">
								<button class="btn btn-default btn-block" role="button">Timbres<span class="badge">9</span></button>
								<button class="btn btn-default btn-block" role="button">Adhérents<span class="badge">15</span></button>
								<button class="btn btn-default btn-block" role="button">Reste à régler<span class="badge red">6</span></button>
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-8">
					<div class="section-block block-text">
						<div class="section-header">
							<h3>Note</h3>
						</div>
						<div class="section-main-content">
							<p>{{ section.infosComp }}</p>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-12 col-sm-12">
					<div class="section-separator"></div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-6">
					<div class="section-block">
						<div class="section-header">
							<h3>Permanences</h3>
						</div>
						<div class="section-main-content">
							<div class="row">
								<div class="col-md-6">
									<button class="btn btn-primary btn-block" role="button"><span class="glyphicons glyphicons-table"></span>Ajouter perm.</button>
								</div>
								<div class="col-md-6">
									<button class="btn btn-primary btn-block" role="button"><span class="glyphicons glyphicons-notes-2"></span>Voir liste perm.</button>
								</div>
							</div>
						</div>
						<div class="section-sub-content text-center">
							<h4>3ème mercredi des mois pairs</h4>
							<div class="row">
								<div class="col-md-4">
									<p>Lieu :<br />
										Local perm.... <br />
										Place V.Fischer
									</p>
								</div>
								<div class="col-md-4">
									<p>Orateur :<br />
										Local perm.... <br />
										Place V.Fischer
									</p>
								</div>
								<div class="col-md-4">
									<p>Horaire :<br />
										Local perm.... <br />
										Place V.Fischer
									</p>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-6">
					<div class="section-block">
						<div class="section-header">
							<h3>Assemblées générales</h3>
						</div>
						<div class="section-main-content">
							<div class="row">
								<div class="col-md-6">
									<button class="btn btn-primary btn-block" role="button"><span class="glyphicons glyphicons-table"></span>Ajouter AG</button>
								</div>
								<div class="col-md-6">
									<button class="btn btn-primary btn-block" role="button"><span class="glyphicons glyphicons-notes-2"></span>Voir liste AG</button>
								</div>
							</div>
						</div>
						<div class="section-sub-content text-center">
							<h4>3ème mercredi des mois pairs</h4>
							<div class="row">
								<div class="col-md-4">
									<p>Lieu :<br />
										Local perm.... <br />
										Place V.Fischer
									</p>
								</div>
								<div class="col-md-4">
									<p>Orateur :<br />
										Local perm.... <br />
										Place V.Fischer
									</p>
								</div>
								<div class="col-md-4">
									<p>Horaire :<br />
										Local perm.... <br />
										Place V.Fischer
									</p>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-12 col-sm-12">
					<div class="section-separator"></div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-12 col-sm-12">
					<div class="section-block">
						<div class="section-header">
							<h3>Patrimoine</h3>
						</div>
						<div class="section-main-content">
							<table>
								<thead>
									<tr>
										<th>
											Année
										</th>
										{% for year in displayedYears %}
											<th><button class="btn btn-link" data-toggle="modal" data-target="#edit-patrimoine-{{ year }}">{{ year }}</button>
											</th>
										{% endfor %}
									</tr>
								</thead>
								<tbody>
									<tr>
										{% set lastPatrimoine = 0 %}
										<td>Patrimoine</td>
										{% for year in displayedYears %}
											<td>{{ patrimoines[year].valeur }}</td>
										{% endfor %}
									</tr>
									<tr>
										<td>Variation</td>
										{% for year in displayedYears %}
											<td>
												{% if patrimoines[year].valeur != 0 and lastPatrimoine != 0 %}
													{% if patrimoines[year].valeur > lastPatrimoine %}
														 +{{ ((patrimoines[year].valeur - lastPatrimoine) / lastPatrimoine * 100)|round(1,'common') }}%
													{% elseif patrimoines[year].valeur < lastPatrimoine %}
														{{ ((patrimoines[year].valeur - lastPatrimoine) / lastPatrimoine * 100)|round(1,'common') }}%
													{% else %}
														+0%
													{% endif %}
												{% else %}
													-
												{% endif %}
											</td>
											{% set lastPatrimoine = patrimoines[year].valeur %}
										{% endfor %}
									</tr>
									<tr>
										<td>Intérêts</td>
										{% for year in displayedYears %}
											<td>{{ patrimoines[year].interets }}</td>
										{% endfor %}
									</tr>
								</tbody>
							</table>
							<br />
							{% include 'modals/liste-patrimoines.html.twig' %}
							<button class="btn btn-default" data-toggle="modal" data-target="#all-patrimoines">Voir tout le patrimoine >></button>
						</div>
						{% for year in allYears %}
							<div class="modal fade" id="edit-patrimoine-{{year}}" tabindex="-1" role="dialog" aria-labelledby="edit-patrimoine-label">
							  <div class="modal-dialog" role="document">
							    <div class="modal-content">
							      <div class="modal-header">
							        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
							        <h4 class="modal-title" id="edit-patrimoine-label">Editer un patrimoine</h4>
							      </div>
							      <div class="modal-body">
							        {{ form(patrimoineForms[year], {'attr': {'novalidate': 'novalidate','id' : 'patrimoine-edit-'~year,'class' : 'clearfix modal-form large-input'}}) }}
							      </div>
							      <div class="modal-footer">
							        <button type="button" class="btn btn-default" data-dismiss="modal">Fermer</button>
							        <button type="button" class="btn btn-primary" onclick="$('form#patrimoine-edit-{{year}}').submit()">Enregistrer</button>
							      </div>
							    </div><!-- /.modal-content -->
							  </div><!-- /.modal-dialog -->
							</div><!-- /.modal -->
						{% endfor %}
					</div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}

